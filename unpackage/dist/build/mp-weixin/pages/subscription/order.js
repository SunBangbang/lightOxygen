(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/subscription/order"],{"61f4":function(t,e,i){"use strict";var n=i("6f4a"),a=i.n(n);a.a},"6f4a":function(t,e,i){},"8a4c":function(t,e,i){"use strict";(function(t){i("8244");n(i("66fd"));var e=n(i("ac30"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=i,t(e.default)}).call(this,i("543d")["createPage"])},"8d0f":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i("cf5b"),a=i("4713"),o=(i("6fa1"),i("e1e9")),r=i("0ddd"),s=i("26cb"),u=c(i("8c9a"));function c(t){return t&&t.__esModule?t:{default:t}}var d=function(){Promise.all([i.e("common/vendor"),i.e("components/home/index")]).then(function(){return resolve(i("af3d"))}.bind(null,i)).catch(i.oe)},l=function(){Promise.all([i.e("common/vendor"),i.e("components/payment/index")]).then(function(){return resolve(i("ec44"))}.bind(null,i)).catch(i.oe)},f=function(){i.e("components/Authorize").then(function(){return resolve(i("5c82"))}.bind(null,i)).catch(i.oe)},h=function(){i.e("components/emptyPage").then(function(){return resolve(i("e4fe"))}.bind(null,i)).catch(i.oe)},p={components:{payment:l,home:d,emptyPage:h,authorize:f},mixins:[u.default],data:function(){return{loading:!1,loadend:!1,loadTitle:"加载更多",orderList1:[{order_num:"#0213620450",status:"立即付款",img:"@/static/images/home-img.png",title:"购买名称测试",money:"470",time:"2018-04-07 13：00"},{order_num:"#0213620450",status:"立即付款",img:"@/static/images/home-img.png",title:"购买名称测试",money:"470",time:"2018-04-07 13：00"}],orderList:[],orderData:{},orderStatus:3,page:1,limit:20,payMode:[{name:"微信支付",icon:"icon-weixinzhifu",value:"weixin",title:"使用微信快捷支付",payStatus:!0},{name:"支付宝支付",icon:"icon-zhifubao",value:"alipay",title:"使用线上支付宝支付",payStatus:!0},{name:"余额支付",icon:"icon-yuezhifu",value:"yue",title:"当前可用余额：",number:0,payStatus:!0},{name:"好友代付",icon:"icon-haoyoudaizhifu",value:"friend",title:"找微信好友支付",payStatus:1}],pay_close:!1,pay_order_id:"",totalPrice:"0",isAuto:!1,isShowAuth:!1,bname:"",name:""}},computed:(0,s.mapGetters)(["isLogin"]),onLoad:function(){},onShow:function(){this.isLogin?(this.page=1,this.orderList=[],this.loadend=!1,this.onLoadFun(),this.breakOrderList()):(0,r.toLogin)()},methods:{onLoadFun:function(){this.getOrderData()},authColse:function(t){this.isShowAuth=t},onChangeFun:function(t){var e=t,i=e.action||null,n=void 0!=e.value?e.value:null;i&&this[i]&&this[i](n)},payClose:function(){this.pay_close=!1},onLoad:function(t){t.status&&(this.orderStatus=t.status)},getOrderData:function(){var t=this,e=this;(0,n.orderData)().then((function(i){e.$set(e,"orderData",i.data),e.payMode.map((function(t){"weixin"==t.value&&(t.payStatus=!!i.data.pay_weixin_open),"alipay"==t.value&&(t.payStatus=!!i.data.ali_pay_status),"yue"==t.value&&(t.payStatus=1==i.data.yue_pay_status),"friend"==t.value&&(t.payStatus=1==i.data.friend_pay_status)})),t.payMode[1].payStatus=!1}))},cancelOrder:function(t,e){var i=this;if(!e)return i.$util.Tips({title:"缺少订单号无法取消订单"});(0,n.orderCancel)(e).then((function(e){return i.$util.Tips({title:e.msg,icon:"success"},(function(){i.orderList.splice(t,1),i.$set(i,"orderList",i.orderList),i.$set(i.orderData,"unpaid_count",i.orderData.unpaid_count-1),i.getOrderData()}))})).catch((function(t){return i.$util.Tips({title:t})}))},goPay:function(t,e){this.$set(this,"pay_close",!0),this.$set(this,"pay_order_id",e),this.$set(this,"totalPrice",t)},pay_complete:function(){this.loadend=!1,this.page=1,this.$set(this,"orderList",[]),this.pay_close=!1,t.navigateTo({url:"/pages/order_pay_status/index?order_id="+this.pay_order_id+"&msg=支付成功&type=3&totalPrice="+this.totalPrice}),this.pay_order_id="",this.getOrderData(),this.getOrderList()},pay_fail:function(){this.pay_close=!1,this.pay_order_id=""},goOrderDetails:function(e){if(!e)return that.$util.Tips({title:"缺少订单号无法查看订单详情"});t.showLoading({title:"正在加载"}),(0,o.openOrderSubscribe)().then((function(){t.hideLoading(),t.navigateTo({url:"/pages/users/order_details/index?order_id="+e})})).catch((function(e){t.hideLoading()}))},statusClick:function(t){t!=this.orderStatus&&(this.orderStatus=t,this.loadend=!1,this.page=1,this.$set(this,"orderList",[]),this.breakOrderList())},breakOrderList:function(){var e=this;if(!e.loadend&&!e.loading){e.loading=!0,e.loadTitle="加载更多";var i=JSON.parse(t.getStorageSync("USER_INFO"));(0,a.breakOrderList)({type:e.orderStatus,page:e.page,limit:e.limit,uid:i.uid}).then((function(t){var i=t.data.list.data||[],n=i.length<e.limit;e.orderList=e.$util.SplitArray(i,e.orderList),e.$set(e,"orderList",e.orderList),e.loadend=n,e.loading=!1,e.loadTitle=n?"我也是有底线的":"加载更多",e.page=e.page+1})).catch((function(t){e.loading=!1,e.loadTitle="加载更多"}))}},delOrder:function(e,i){var a=this;t.showModal({title:"删除订单",content:"确定删除该订单",success:function(t){if(t.confirm)(0,n.orderDel)(e).then((function(t){return a.orderList.splice(i,1),a.$set(a,"orderList",a.orderList),a.$set(a.orderData,"unpaid_count",a.orderData.unpaid_count-1),a.getOrderData(),a.$util.Tips({title:"删除成功",icon:"success"})})).catch((function(t){return a.$util.Tips({title:t})}));else if(t.cancel)return a.$util.Tips({title:"已取消"})}})}},onReachBottom:function(){this.getOrderList()}};e.default=p}).call(this,i("543d")["default"])},ac30:function(t,e,i){"use strict";i.r(e);var n=i("cc30"),a=i("f500");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("61f4");var r,s=i("f0c5"),u=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"1a68731c",null,!1,n["a"],r);e["default"]=u.exports},cc30:function(t,e,i){"use strict";var n;i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}));var a=function(){var t=this,e=t.$createElement;t._self._c},o=[]},f500:function(t,e,i){"use strict";i.r(e);var n=i("8d0f"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=a.a}},[["8a4c","common/runtime","common/vendor"]]]);